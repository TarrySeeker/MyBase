# Инструкция по настройке базы данных (Supabase)

Supabase — это современная замена стандартным базам данных. Она хранит товары, заказы и заявки с вашего сайта.
Для каждого клиента мы создаем **отдельный проект**, чтобы данные были в безопасности и принадлежали только владельцу.

## Шаг 1: Регистрация и создание проекта

1. Перейдите на [сайт Supabase](https://supabase.com/).
2. Нажмите **"Start your project"** и войдите (можно через GitHub).
3. Нажмите **"New Project"**.
4. Заполните форму:
   - **Name**: Название вашего магазина (на латинице, например `MyShop`).
   - **Database Password**: Придумайте сложный пароль и **сохраните его** (он понадобится позже).
   - **Region**: Выберите ближайший (например, `Frankfurt`).
   - **Pricing Plan**: Free (бесплатно, хватает для старта).
5. Нажмите **"Create new project"**.
6. Подождите пару минут, пока проект создается.

## Шаг 2: Получение ключей доступа

Эти ключи нужны, чтобы ваш сайт мог общаться с базой данных.

1. В панели управления проектом перейдите в **Settings** (шестеренка внизу слева) -> **API**.
2. Найдите блок **Project URL** и скопируйте `URL`.
3. Найдите блок **Project API keys** и скопируйте `anon` `public` ключ.
4. Передайте эти два значения разработчику (GreenBox) для подключения сайта.

> ⚠️ **Важно**: Никогда не передавайте ключ `service_role` (secret), он дает полный доступ к базе данных в обход правил безопасности.

## Шаг 3: Настройка структуры базы (Автоматически)

Чтобы не создавать таблицы вручную, мы подготовили скрипт.

1. В меню слева выберите **SQL Editor** (иконка консоли `>_`).
2. Нажмите **"New query"**.
3. Скопируйте код из файла `schema.sql` (который вам предоставил разработчик) и вставьте его в поле.
4. Нажмите кнопку **"Run"** (справа внизу).
5. Если в нижнем окне появилось `Success`, значит база настроена!

## Шаг 4: Настройка Уведомлений (Email)

Чтобы получать уведомления о заказах:

1. Зайдите в **Authentication** -> **Email Templates**.
2. Здесь можно настроить шаблоны писем (подтверждение регистрации и т.д.).
3. Для отправки уведомлений о заказах мы используем внешнюю интеграцию в коде сайта, но вам нужно убедиться, что SMTP сервер (почта) не блокирует отправку.
   - *Рекомендуется*: Настроить Custom SMTP в **Settings** -> **Authentication** -> **SMTP Settings** (используйте почту вашего домена).

## Шаг 5: Проверка работы

1. Зайдите в **Table Editor** (иконка таблицы слева).
2. Вы должны увидеть созданные таблицы: `products`, `orders`, `applications`, `cms_content`, `promo_codes`.
3. Попробуйте создать тестовый товар в таблице `products` (кнопка "Insert row"), чтобы убедиться, что все работает.

---
**Поздравляем! Ваша база данных готова к работе.**
Если возникнут вопросы, обратитесь в поддержку GreenBox.
